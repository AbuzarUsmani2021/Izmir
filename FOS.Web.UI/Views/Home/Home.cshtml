@model FOS.Shared.KSBComplaintData

@{
    ViewBag.Title = "WASA LAHORE | Today Complaints";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<style>
    .table-responsive {
        display: block;
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
    }

    .grid-container {
        display: grid;
        grid-template-columns: auto auto auto auto;
        padding: 20px;
        background-color: #1969b1;
    }

    .label {
        color: white;
    }

    .grid-item {
        color: white;
    }
</style>

<link href="~/Content/Style/morris.css" rel="stylesheet" />


<link href="http://code.jquery.com/ui/1.10.4/themes/ui-lightness/jquery-ui.css" rel="stylesheet">
<script src="http://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>

<!-- BEGIN PAGE HEADER-->
<h3 class="page-title"></h3>
@*<ul class="breadcrumb">
        <li>
            <a href="#">Complaints</a>
            <span class="divider">/</span>
        </li>
        <li>
            <a href="#">Today's All Complaints</a>
        </li>
    </ul>*@
<div class="widget-title text-center" style=" background-color: #1969b1;">
    <h4><strong> All Complaints Detail</strong></h4>
    <hr style="margin:13px;" />
</div>

<div class="grid-container">
    <div class="grid-item">
        <label>From Date:</label>
        <div class="controls">
            <input class="text-box single-line" id="StartingDate1" name="StartingDate1" style="height: 22px; width: 202px; margin-bottom: 0px;" placeholder="DD-MM-YYYY">
        </div>
    </div>
    <div class="grid-item">
        <label>To Date:</label>
        <div class="controls">
            <input class="text-box single-line" id="StartingDate2" name="StartingDate2" style="height: 22px; width: 202px; margin-bottom: 0px;" placeholder="DD-MM-YYYY">
        </div>
    </div>
    <div class="grid-item">
        <label>Project:</label>
        <div class="controls" style="margin-left: 0px">
            @Html.DropDownListFor(model => model.ProjectId, new SelectList(Model.SaleOfficers, "ID", "Name"), new { @class = "" })
            @Html.HiddenFor(model => model.ProjectId)
            @Html.ValidationMessageFor(model => model.ProjectId)
        </div>
    </div>
    <div class="grid-item" style="margin-top: 28px;">
        <button type="submit" id="btnNew" class="btn btn-primary">
            <i class="icon-ok icon-white" style="padding-right: 2px"></i><span style="width:50px" id="create">Apply Filter</span>
        </button>
    </div>



</div>

<div class="table-responsive">
    <table class="table table-striped table-hover table-bordered" id="datatab">
        <thead>
            <tr>
                <th>
                    @Html.DisplayNameFor(model => model.ID)
                </th>
                <th>

                </th>
                <th>

                </th>
                <th>Sr #</th>
                <th>
                    Complaint No
                </th>


                <th>
                    Site ID
                </th>
                <th>
                    Site Name
                </th>
                <th>
                    Fault Type
                </th>
                <th>
                    Complaint Type
                </th>
                <th>
                    Registered By
                </th>
                <th>
                    Registered At
                </th>

                <th>
                    Elapsed Time (HH:MM)
                </th>



                <th id="StatusColumn">Status</th>
                <th id="StatusColumn">Progress Status</th>
                <th id="StatusColumn">Updated At(HH:MM)</th>
                <th>Detail</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>




    <div id="myModal" class="modal fade" role="dialog">

        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header" style="margin-left: 25px; margin-right: 25px;">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title" style="font-weight: 900; color: #951b26;">View Complaint Information</h4>
                </div>
                <div class="modal-body" style="overflow-y: auto;">

                    <div>
                        <div class="clearfix">
                            @*<div class="btn-group">
                                    <button id="editable-sample_new" class="btn green">
                                        Add New <i class="icon-plus"></i>
                                    </button>
                                </div>*@
                            <div class="btn-group pull-right"></div>
                        </div>
                        @using (Html.BeginForm("NewComplaints", "Complaint", FormMethod.Post, new { enctype = "multipart/form-data" }))
                        {

                            @Html.AntiForgeryToken()
                            @Html.ValidationSummary(true)

                            <div class="form-group">

                                <div class="span12">
                                    <div class="span3" style="margin-top: 0px;">



                                        <!-- Select RegionalHead -->
                                        <div class="control-group">
                                            <label class="control-label">Select Client *</label>
                                            <div class="controls" style="float: left; margin-left: auto;">
                                                @Html.DropDownListFor(model => model.ClientId, new SelectList(Model.Client, "ID", "Name"), new { @class = "" })
                                                @Html.ValidationMessageFor(model => model.ClientId)
                                                @Html.HiddenFor(model => model.ClientId)
                                            </div>
                                        </div>




                                        <div class="control-group" style="margin-bottom: 10px">
                                            <label class="control-label">Select Project *</label>
                                            <div class="controls" style="margin-left: 0px">
                                                @Html.DropDownListFor(model => model.ProjectId, new SelectList(Model.SaleOfficers, "ID", "Name"), new { @class = "" })
                                                @Html.HiddenFor(model => model.ProjectId)
                                                @Html.ValidationMessageFor(model => model.ProjectId)
                                            </div>
                                        </div>



                                        <div class="control-group" style="margin-bottom: 10px">
                                            <label class="control-label">Select Zone *</label>
                                            <div class="controls" style="margin-left: 0px">
                                                @Html.DropDownListFor(model => model.CityID, new SelectList(Model.Cities, "ID", "Name"), new { @class = "" })
                                                @Html.ValidationMessageFor(model => model.CityID)
                                            </div>
                                        </div>

                                        <div class="control-group" style="margin-bottom: 10px">
                                            <label class="control-label">Select Town *</label>
                                            <div class="controls" style="margin-left: 0px">
                                                @Html.DropDownListFor(model => model.AreaID, new SelectList(Model.Areas, "ID", "Name"), new { @class = "Areas" })
                                                @Html.HiddenFor(model => model.AreaID)
                                            </div>
                                        </div>

                                        <div class="control-group" style="margin-bottom: 10px">
                                            <label class="control-label">Select Sub Division *</label>
                                            <div class="controls" style="margin-left: 0px">
                                                @Html.DropDownListFor(model => model.SubDivisionID, new SelectList(Model.SubDivisions, "ID", "Name"), new { @class = "Areas" })
                                                @Html.HiddenFor(model => model.SubDivisionID)
                                            </div>
                                        </div>


                                        <div class="control-group" style="margin-bottom: 10px">
                                            <label class="control-label">Select Site *</label>
                                            <div class="controls" style="margin-left: 0px">
                                                @Html.DropDownListFor(model => model.SiteId, new SelectList(Model.Sites, "ID", "Name"), new { @class = "Areas" })
                                                @Html.HiddenFor(model => model.SiteId)
                                            </div>
                                        </div>

                                        <div class="control-group" style="margin-bottom: 0px">
                                            <label class="control-label" style="">Site ID</label>
                                            <div class="controls" style="margin-left: 0px">
                                                @Html.EditorFor(model => model.DisableSiteID)
                                            </div>
                                        </div>
                                        <div class="control-group" style="margin-bottom: 10px">
                                            <label class="control-label">Launched By *</label>
                                            <div class="controls" style="margin-left: 0px">
                                                @Html.DropDownListFor(model => model.LaunchedByID, new SelectList(Model.LaunchedBy, "ID", "Name"), new { @class = "Areas" })
                                                @Html.HiddenFor(model => model.LaunchedByID)
                                            </div>
                                        </div>
                                    </div>

                                    <div class="span3" style="margin-top: 0px;">

                                        <div class="control-group" style="margin-bottom: 10px">
                                            <label class="control-label">Select Fault Type *</label>
                                            <div class="controls" style="margin-left: 0px">
                                                @Html.DropDownListFor(model => model.FaulttypeId, new SelectList(Model.faultTypes, "Id", "Name"), new { @class = "Areas" })
                                                @Html.HiddenFor(model => model.FaulttypeId)
                                            </div>
                                        </div>
                                        <div class="control-group" style="margin-bottom: 10px">
                                            <label class="control-label">Select Fault Type Detail *</label>
                                            <div class="controls" style="margin-left: 0px">
                                                @Html.DropDownListFor(model => model.FaulttypeDetailId, new SelectList(Model.faultTypesDetail, "Id", "Name"), new { @class = "Areas" })
                                                @Html.HiddenFor(model => model.FaulttypeDetailId)
                                            </div>
                                        </div>
                                        <div class="control-group" style="margin-bottom: 0px">
                                            <label class="control-label" style="">Other Remarks</label>
                                            <div class="controls" style="margin-left: 0px">
                                                @Html.TextAreaFor(model => model.FaultTypeDetailOtherRemarks)
                                            </div>
                                        </div>
                                        <div class="control-group" style="margin-bottom: 10px">
                                            <label class="control-label">Select Priority *</label>
                                            <div class="controls" style="margin-left: 0px">
                                                @Html.DropDownListFor(model => model.PriorityId, new SelectList(Model.priorityDatas, "ID", "Name"), new { @class = "Areas" })
                                                @Html.HiddenFor(model => model.PriorityId)
                                            </div>
                                        </div>


                                        <div class="control-group" style="margin-bottom: 10px">
                                            <label class="control-label">Select Status *</label>
                                            <div class="controls" style="margin-left: 0px">
                                                @Html.DropDownListFor(model => model.StatusID, new SelectList(Model.complaintStatuses, "ID", "Name"), new { @class = "Areas" })
                                                @Html.HiddenFor(model => model.StatusID)
                                            </div>
                                        </div>
                                        <div class="control-group" style="margin-bottom: 10px">
                                            <label class="control-label">Complaint Type *</label>
                                            <div class="controls" style="margin-left: 0px">
                                                @Html.DropDownListFor(model => model.ComplaintTypeID, new SelectList(Model.ComplaintTypes, "ID", "Name"), new { @class = "Areas" })
                                                @Html.HiddenFor(model => model.ComplaintTypeID)
                                            </div>
                                        </div>
                                        <div class="control-group" style="margin-bottom: 10px">
                                            <label class="control-label">Progress Status *</label>
                                            <div class="controls" style="margin-left: 0px">
                                                @Html.DropDownListFor(model => model.ProgressStatusId, new SelectList(Model.ProgressStatus, "ID", "Name"), new { @class = "Areas" })
                                                @Html.HiddenFor(model => model.ProgressStatusId)
                                            </div>
                                        </div>

                                        <div class="control-group" style="margin-bottom: 0px">
                                            <label class="control-label" style="">Progress Status Remarks</label>
                                            <div class="controls" style="margin-left: 0px">
                                                @Html.TextAreaFor(model => model.ProgressStatusOtherRemarks)
                                            </div>
                                        </div>







                                    </div>


                                    <div class="span3" style="margin-top: 0px;">

                                        <div class="control-group" style="margin-bottom: 0px">
                                            <label class="control-label" style="">Image1</label>

                                            @*<img src="~/Images/ComplaintImages/12.png"  />*@
                                            <img src="~/Images/ComplaintImages/12.jpg" width="70" height="70" />
                                        </div>
                                        <div class="control-group" style="margin-bottom: 0px">
                                            <label class="control-label" style="">Image2</label>
                                            <img src="~/Images/ComplaintImages/144.jpg" width="70" height="70" />

                                        </div>


                                        @*<div class="control-group" style="margin-bottom: 0px">
                                                <label class="control-label" style="">Image3</label>

                                                <img src="~/Images/ComplaintImages/download.jpg" width="70" height="70" />

                                            </div>*@



                                        <!-- Buttons -->



                                    </div>


                                    <div class="span3" style="margin-top: 0px;">



                                        <div class="control-group" style="margin-bottom: 0px">
                                            <label class="control-label" style="">Remarks</label>
                                            <div class="controls" style="margin-left: 0px">
                                                @Html.TextAreaFor(model => model.Remarks)
                                            </div>
                                        </div>

                                        @*<div class="control-group" style="margin-bottom: 0px">
                                                <label class="control-label" style="">Image4</label>


                                                <img src="~/Images/ComplaintImages/fb.png" width="70" height="70" />

                                            </div>*@
                                        @*<div class="control-group" style="margin-bottom: 0px">
                                                <label class="control-label" style="">Image5</label>



                                                <img src="~/Images/ComplaintImages/images.jpg" width="70" height="70" />
                                            </div>*@

                                        <!-- Buttons -->



                                    </div>

                                </div>

                            </div>

                        }
                    </div>
                    <div>
                        <div class="clearfix">
                            @*<div class="btn-group">
                                    <button id="editable-sample_new" class="btn green">
                                        Add New <i class="icon-plus"></i>
                                    </button>
                                </div>*@
                            <div class="btn-group pull-right"></div>
                        </div>
                        <div class="space15"></div>
                        <h2 style="margin-top: -10px;text-align:center;color: #62c462;font-weight: bolder;border-bottom: 1px solid #62c462;border-top: 1px solid #62c462;padding-bottom: 10px;padding-top: 10px;" id="jobstatus">Complaint Details</h2>
                        <div class="span12" style="padding:0px">

                            <table class="table table-striped table-hover table-bordered">

                                <thead>
                                    <tr style="width:70px">


                                        <th style="width:auto !important">
                                            UpdatedOn
                                        </th>

                                        <th style="width:auto !important">
                                            Updated By
                                        </th>

                                        <th style="width:auto !important">
                                            Progress Status
                                        </th>

                                        <th style="width:auto !important">
                                            Progress Status Remarks
                                        </th>
                                        <th style="width:auto !important">
                                            Picture
                                        </th>
                                    </tr>
                                </thead>


                            </table>

                        </div>



                        <table class="table table-striped table-hover table-bordered" id="tbldetails">

                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
   
</div>




@*<ul class="breadcrumb">
        <li>
            <label> From Date</label>
            <div class="controls">
                <input class="text-box single-line" id="StartingDate1" name="StartingDate1" style="height: 22px; width: 202px; margin-bottom: 0px;">

            </div>
        </li>
        <li style="margin-left:30px">
            <h6> To Date</h6>
            <div class="controls">
                <input class="text-box single-line" id="StartingDate2" name="StartingDate2" style="height: 22px; width: 202px; margin-bottom: 0px;">
            </div>
        </li>
        <li style="margin-left:30px">
            <h6> Project</h6>
            <div class="controls" style="margin-left: 0px">
                @Html.DropDownListFor(model => model.ProjectId, new SelectList(Model.SaleOfficers, "ID", "Name"), new { @class = "" })
                @Html.HiddenFor(model => model.ProjectId)
                @Html.ValidationMessageFor(model => model.ProjectId)
            </div>
        </li>
        <li style="margin-left:30px">
            <button type="submit" id="btnNew" class="btn btn-primary">
                <i class="icon-ok icon-white" style="padding-right: 2px"></i><span style="width:50px" id="create">Apply Filter</span>
            </button>

            <input type="button" id="btnAction" value="Detail" onclick="location.href='@Url.Action("FilteredDashboard", "Home")?sdate=' + document.getElementById('StartingDate1').value +'&edate='+document.getElementById('StartingDate2').value + '&TID='+document.getElementById('ProjectId').value " />
        </li>
    </ul>*@








    <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>

    <script>

     function GenerateDetailGrid()
        {
        var oTable = $('#datatab').DataTable
            ({
            "aLengthMenu": [[10, 25, 50, 75, 100], [10, 25, 50, 75, 100]],
            "iDisplayLength": 3,
            "lengthChange": false,
            "pagingType": "full_numbers",
            "info": true,
            "serverSide": true,
            "bRetrieve": true,
            "bDestroy": true,
            "autoWidth": false,
            "ajax": {
                "type": "POST",
                "url": '@Url.Action("HomeComplaintsDataHandler", "RetailerOrders")',
                "contentType": 'application/json; charset=utf-8',
                'data': function (data) {
                    data.DealerID = $('#DealerID').val();
                    return data = JSON.stringify(data);

                },

            },
            "fnDrawCallback": function (osetting) {

                var UpdateCheck = "0";
                var DeleteCheck = "0";

                if (UpdateCheck == "@HttpContext.Current.Session["UpdateCheck"]") { $(".edit").css("display", "none"); }

                else {

                    $(".edit").on("click", function () {
                        debugger;


                        var edit = $(this);
                        var RetailerID = $(this).attr("data-id");

                        $.ajax({
                            type: "POST",
                            url: "@Url.Action("GetEditComplaint", "Complaint")",
                            data: { ComplaintId: RetailerID },
                            success: function (Response) {
                                debugger;
                                if (Response != null) {
                                    $('#ID').val(Response.ID);
                                    $('#ClientId').attr('disabled', true);
                                    $("#ClientId").val(Response.RegionID);

                                    $('#ProjectId').attr('disabled', true);

                                    $("#ProjectId").val(Response.ZoneId);
                                    $('#CityID').attr('disabled', true);

                                    $("#CityID").val(Response.CityID);
                                    $('#AreaID').attr('disabled', true);
                                    $("#AreaID").val(Response.AreaID);
                                    $("#SiteId").val(Response.RetailerID);
                                    $('#SiteId').attr('disabled', true);
                                    $('#SubDivisionID').attr('disabled', true);
                                    $('#SubDivisionID').css("background-color", "#eee");
                                    $("#SubDivisionID").val(Response.SubDivisionID);
                                    $("#FaulttypeId").val(Response.FaulttypeId);
                                    $("#FaulttypeDetailId").val(Response.FaulttypeDetailId);
                                    $("#ProgressStatusOtherRemarks").val(Response.ProgressStatusOtherRemarks);
                                    $("#FaultTypeDetailOtherRemarks").val(Response.FaultTypeDetailOtherRemarks);
                                    $("#PriorityId").val(Response.PriorityID);
                                    $("#StatusID").val(Response.StatusID);
                                    $("#ProgressStatusId").val(Response.ProgressStatusId);
                                    $("#ComplaintTypeID").val(Response.ComplaintTypeID);
                                    $("#LaunchedById").val(Response.LaunchedByID);
                                    $("#Remarks").val(Response.Remarks);
                                    $("#Name").val(Response.Name);

                                    $('#DisableSiteID').attr('disabled', true);
                                    $('#DisableSiteID').css("background-color", "#eee");
                                    $("#DisableSiteID").val(Response.DisableSiteID);


                                }

                                else { alertify.error('An Error Occured, Try Again...'); }
                            }

                        });

                        $("#Areas").change(function () {
                            $("#AreaNameID").val($(this).val());
                        });

                        $('html, body').animate({
                            //scrollTop: $("#main-content").offset().top
                        }, 500);


                        var JobID = ($(this).attr("data-id"));
                        debugger;
                        $.ajax({

                            type: "POST",
                            data: { JobID: JobID },
                            url: "@Url.Action("GetComplaintDetailsToID", "Job")",

                            dataType: 'JSON',
                            success: function (json) {
                                debugger;
                                var row = "";

                                $.each(json, function (value, key) {

                                    var jsonDate = key.JobDate;
                                    var value = new Date(parseInt(jsonDate.toString().substr(6)));
                                    var finalResult = value.getMonth() + 1 + "/" + value.getDate() + "/" +
                                        value.getFullYear();
                                    row += "<tr><td style='width:210px'>" + finalResult + "</td><td style='width:200px'>" + key.UpdatedBy + "</td><td style='width:270px'>" + key.ProgressStatus + "</td><td>" + key.ProgressRemarks + "</td><td>  </td></tr>";

                                });

                                $('#tbldetails').append(row);


                                $("#tbldetails").html(row);
                            }

                        });
                    });






                }

                if (UpdateCheck == "@HttpContext.Current.Session["DeleteCheck"]") { $(".delete").css("display", "none"); }
                else {

                    $(".delete").on("click", function () {

                        var RetailerID = $(this).attr("data-id");

                        // confirm dialog
                        alertify.confirm("Are You Sure You Want To Delete This Record ?  ", function (e) {
                            if (e) {

                                $.ajax({
                                    type: "POST",
                                    url: "@Url.Action("DeleteRetailer", "Retailer")",
                                    data: { retailerID: RetailerID },
                                    success: function (data) {

                                        if (data == "0") {
                                            alertify.success('Record Deleted Successfully');
                                            var table = $('#datatab').DataTable();
                                            table.row(this).remove().draw(false);
                                        }

                                        else { alertify.error('An Error Occured, Try Again...'); }
                                    }

                                });

                            } else { }
                        });

                    });

                }
            },

            "fnRowCallback": function (nRow, aData, iDisplayIndex) {
                $("td:first", nRow).html(iDisplayIndex + 1);

                debugger;
                if (aData["StatusID"] == "3")
                {
                    $(nRow).find('td:eq(9)').css('background-color', '#A0B978');
                   // $('td', nRow).css('background-color', 'Green');
                }
                if (aData["StatusID"] == "4") {
                    $(nRow).find('td:eq(9)').css('background-color', '#F0E801');
                }
                if (aData["ComplaintTypeName"] == "Major") {
                    $(nRow).find('td:eq(5)').css('background-color', 'red');
                }


                return nRow;
            },

            "searching": false,
            "processing": true,
            "deferRender": true,
            "bSelect": false,
            "columns": [
                { "data": "ID", "bVisible": false },
                { "data": "DealerID", "bVisible": false },
                { "data": "SaleOfficerID", "bVisible": false },
                { "data": "ID" },
                { "data": "TicketNo" },

                { "data": "SiteCode", "sClass": "center-align-td",},
                { "data": "RetailerName" },
                { "data": "FaultTypeFinalName" },
                { "data": "ComplaintTypeName", "sClass": "center-align-td", },
                {

                    "data": "SaleOfficerName"



                },
                { "data": "dateformat", "sClass": "center-align-td", },
                { "data": "VisitDateFormatted","sClass": "center-align-td", },



                {
                    "data": "StatusName", "sClass": "center-align-td",



                },
     {
         "data": "ProgressStatus"



                },
                {
                    "data": "UpdatedAt", "sClass": "center-align-td",



                },

                {
                    "sClass": "center-align-td",
                    "mData": null,
                    "bSortable": false,
                    "mRender": function (data, type, row) {

                        // alert('<button class="btn btn-success edit" data-id=' + row.ID + '' + ' data-saleofficer=' + '"' + row.SaleOfficerName + '"' + ' data-ShopName=' + '"' + row.ShopName + '"' + ' data-VisitPlanName=' + '"' + row.VisitPlanName + '"' + ' data-RetailerType=' + '"' + row.RetailerType + '"' + ' data-visitplan=' + '"' + row.VisitPlanName + '"' + ' data-visittype=' + '"' + row.VisitType + '"' + ' data-retailertype=' + '"' + row.RetailerType + '"' + ' data-savailability=' + '"' + row.SAvailable + '"' + ' data-squantity1kg=' + '"' + row.SQuantity1KG + '"' + ' data-squantity5kg=' + '"' + row.SQuantity5KG + '"' + 'data-sneworder=' + '"' + row.SNewOrder + '"' + ' data-snewquantity1kg=' + '"' + row.SNewQuantity1KG + '"' + ' data-snewquantity5kg=' + '"' + row.SNewQuantity5KG + '"' + ' data-spreviousorder1kg=' + '"' + row.SPreviousOrder1KG + '"' + ' data-spreviousorder5kg=' + '"' + row.SPreviousOrder5KG + '"' + ' data-sposmaterialavailable=' + '"' + row.SPOSMaterialAvailable + '"' + ' data-simage=' + '"' + row.SImage + '"' + 'data-snote=' + '"' + row.SNote + '"' + 'data-pusewc=' + '"' + row.PUseWC + '"' + ' data-pusewc1kg=' + '"' + row.PUseWC1KG + '"' + ' data-pusewc5kg=' + '"' + row.PUseWC5KG + '"' + ' data-pneworder=' + '"' + row.PNewOrder + '"' + ' data-pneworder1kg=' + '"' + row.PNewOrder1KG + '"' + ' data-pneworder5kg=' + '"' + row.PNewOrder5KG + '"' + ' data-pnewlead=' + '"' + row.PNewLead + '"' + ' data-pnewleadmobno=' + '"' + row.PNewLeadMobNo + '"' + ' data-premarks=' + '"' + row.PRemarks + '"' + 'data-bareaid=' + '"' + row.BAreaName + '"' + ' data-bshop=' + '"' + row.BShop + '"' + ' data-boldhouse=' + '"' + row.BOldHouse + '"' + ' data-bnewhouse=' + '"' + row.BNewHouse + '"' + ' data-bparking=' + '"' + row.BParking + '"' + ' data-bplazabasement=' + '"' + row.BPlazaBasement + '"' + ' data-bfactoryarea=' + '"' + row.BFactoryArea + '"' + ' data-bmosque=' + '"' + row.BMosque + '"' + ' data-bothers=' + '"' + row.BOthers + '"' + ' data-blead=' + '"' + row.BLead + '"' + ' data-bsampleapplied=' + '"' + row.BSampleApplied + '"' + ' data-bremarks=' + '"' + row.BRemarks + '"' + ' data-statuschecker=' + '"' + row.StatusChecker + '"' + ' data-assigndate=' + '"' + row.AssignDate + '"' + ' data-visiteddate=' + '"' + row.VisitedDate + '"' + 'data-visitdate=' + '"' + row.VisitDate + '"' + 'data-address=' + '"' + row.Address + '"' + '><i class=icon-file-text-alt></i></button>');
                        // return '<button class="btn btn-success edit" data-id=' + row.JobID + '' + ' data-saleofficer=' + '"' + row.SaleOfficerName + '"' + ' data-ShopName=' + '"' + row.ShopName + '"' + ' data-VisitPlanName=' + '"' + row.VisitPlanName + '"' + ' data-RetailerType=' + '"' + row.RetailerType + '"' + ' data-visitplan=' + '"' + row.VisitPlanName + '"' + ' data-visittype=' + '"' + row.VisitType + '"' + ' data-retailertype=' + '"' + row.RetailerType + '"' + ' data-savailability=' + '"' + row.SAvailable + '"' + ' data-squantity1kg=' + '"' + row.SQuantity1KG + '"' + ' data-squantity5kg=' + '"' + row.SQuantity5KG + '"' + 'data-sneworder=' + '"' + row.SNewOrder + '"' + ' data-snewquantity1kg=' + '"' + row.SNewQuantity1KG + '"' + ' data-snewquantity5kg=' + '"' + row.SNewQuantity5KG + '"' + ' data-spreviousorder1kg=' + '"' + row.SPreviousOrder1KG + '"' + ' data-spreviousorder5kg=' + '"' + row.SPreviousOrder5KG + '"' + ' data-sposmaterialavailable=' + '"' + row.SPOSMaterialAvailable + '"' + ' data-simage=' + '"' + row.SImage + '"' + 'data-snote=' + '"' + row.SNote + '"' + 'data-pusewc=' + '"' + row.PUseWC + '"' + ' data-pusewc1kg=' + '"' + row.PUseWC1KG + '"' + ' data-pusewc5kg=' + '"' + row.PUseWC5KG + '"' + ' data-pneworder=' + '"' + row.PNewOrder + '"' + ' data-pneworder1kg=' + '"' + row.PNewOrder1KG + '"' + ' data-pneworder5kg=' + '"' + row.PNewOrder5KG + '"' + ' data-pnewlead=' + '"' + row.PNewLead + '"' + ' data-pnewleadmobno=' + '"' + row.PNewLeadMobNo + '"' + ' data-premarks=' + '"' + row.PRemarks + '"' + 'data-bareaid=' + '"' + row.BAreaName + '"' + ' data-bshop=' + '"' + row.BShop + '"' + ' data-boldhouse=' + '"' + row.BOldHouse + '"' + ' data-bnewhouse=' + '"' + row.BNewHouse + '"' + ' data-bparking=' + '"' + row.BParking + '"' + ' data-bplazabasement=' + '"' + row.BPlazaBasement + '"' + ' data-bfactoryarea=' + '"' + row.BFactoryArea + '"' + ' data-bmosque=' + '"' + row.BMosque + '"' + ' data-bothers=' + '"' + row.BOthers + '"' + ' data-blead=' + '"' + row.BLead + '"' + ' data-bsampleapplied=' + '"' + row.BSampleApplied + '"' + ' data-bremarks=' + '"' + row.BRemarks + '"' + ' data-statuschecker=' + '"' + row.StatusChecker + '"' + ' data-assigndate=' + '"' + row.AssignDate + '"' + ' data-visiteddate=' + '"' + row.VisitedDate + '"' + 'data-visitdate=' + '"' + row.VisitDate + '"' + 'data-address=' + '"' + row.Address + '"' + '><i class=icon-pencil></i></button><button class="btn btn-primary view" data-id=' + row.JobID + '' + ' data-saleofficer=' + '"' + row.SaleOfficerName + '"' + ' data-ShopName=' + '"' + row.ShopName + '"' + ' data-VisitPlanName=' + '"' + row.VisitPlanName + '"' + ' data-RetailerType=' + '"' + row.RetailerType + '"' + ' data-visitplan=' + '"' + row.VisitPlanName + '"' + ' data-visittype=' + '"' + row.VisitType + '"' + ' data-retailertype=' + '"' + row.RetailerType + '"' + ' data-savailability=' + '"' + row.SAvailable + '"' + ' data-squantity1kg=' + '"' + row.SQuantity1KG + '"' + ' data-squantity5kg=' + '"' + row.SQuantity5KG + '"' + 'data-sneworder=' + '"' + row.SNewOrder + '"' + ' data-snewquantity1kg=' + '"' + row.SNewQuantity1KG + '"' + ' data-snewquantity5kg=' + '"' + row.SNewQuantity5KG + '"' + ' data-spreviousorder1kg=' + '"' + row.SPreviousOrder1KG + '"' + ' data-spreviousorder5kg=' + '"' + row.SPreviousOrder5KG + '"' + ' data-sposmaterialavailable=' + '"' + row.SPOSMaterialAvailable + '"' + ' data-simage=' + '"' + row.SImage + '"' + 'data-snote=' + '"' + row.SNote + '"' + 'data-pusewc=' + '"' + row.PUseWC + '"' + ' data-pusewc1kg=' + '"' + row.PUseWC1KG + '"' + ' data-pusewc5kg=' + '"' + row.PUseWC5KG + '"' + ' data-pneworder=' + '"' + row.PNewOrder + '"' + ' data-pneworder1kg=' + '"' + row.PNewOrder1KG + '"' + ' data-pneworder5kg=' + '"' + row.PNewOrder5KG + '"' + ' data-pnewlead=' + '"' + row.PNewLead + '"' + ' data-pnewleadmobno=' + '"' + row.PNewLeadMobNo + '"' + ' data-premarks=' + '"' + row.PRemarks + '"' + 'data-bareaid=' + '"' + row.BAreaName + '"' + ' data-bshop=' + '"' + row.BShop + '"' + ' data-boldhouse=' + '"' + row.BOldHouse + '"' + ' data-bnewhouse=' + '"' + row.BNewHouse + '"' + ' data-bparking=' + '"' + row.BParking + '"' + ' data-bplazabasement=' + '"' + row.BPlazaBasement + '"' + ' data-bfactoryarea=' + '"' + row.BFactoryArea + '"' + ' data-bmosque=' + '"' + row.BMosque + '"' + ' data-bothers=' + '"' + row.BOthers + '"' + ' data-blead=' + '"' + row.BLead + '"' + ' data-bsampleapplied=' + '"' + row.BSampleApplied + '"' + ' data-bremarks=' + '"' + row.BRemarks + '"' + ' data-statuschecker=' + '"' + row.StatusChecker + '"' + ' data-assigndate=' + '"' + row.AssignDate + '"' + ' data-visiteddate=' + '"' + row.VisitedDate + '"' + 'data-visitdate=' + '"' + row.VisitDate + '"' + 'data-address=' + '"' + row.Address + '"' + '><i class=icon-file-text-alt></i></button>';

                        return '<button class="btn btn-success edit" data-id=' + '"' + row.ID + '"' + ' data-toggle="modal" data-target="#myModal">' + '<i class=icon-pencil></i>' + '</button>';
                    }
                }
                ], "order": [0, "desc"]

            });
            var table = $('#datatab').DataTable();
            setInterval(function () {
                var info = table.page.info();
                var pageNum = (info.page < info.pages) ? info.page + 1 : 1;
                table.page(pageNum).draw(false);
            }, 120000);
        }












    </script>






    <script src="@Url.Content("~/Scripts/js/jquery.fileDownload.js")"></script>




    <script>



      



     







    $(document).ready(function () {


            GenerateDetailGrid();
            $('input[name=StartingDate1]').css({ "height": "22px", "width": "202px", "margin-bottom": "0px" });
            $('input[name=StartingDate1]').datepicker({ dateFormat: "dd-MM-yy" });
            $("input[name=StartingDate1]").trigger('change');

            $('input[name=EndingDate1]').css({ "height": "22px", "width": "202px", "margin-bottom": "0px" });
            $('input[name=EndingDate1]').datepicker({ dateFormat: "dd-MM-yy" });
            $("input[name=EndingDate1]").trigger('change');

            $('input[name=StartingDate2]').css({ "height": "22px", "width": "202px", "margin-bottom": "0px" });
            $('input[name=StartingDate2]').datepicker({ dateFormat: "dd-MM-yy" });
            $("input[name=StartingDate2]").trigger('change');

            $('input[name=EndingDate2]').css({ "height": "22px", "width": "202px", "margin-bottom": "0px" });
            $('input[name=EndingDate2]').datepicker({ dateFormat: "dd-MM-yy" });
            $("input[name=EndingDate2]").trigger('change');

            $('input[name=StartingDate3]').css({ "height": "22px", "width": "202px", "margin-bottom": "0px" });
            $('input[name=StartingDate3]').datepicker({ dateFormat: "dd-MM-yy" });
            $("input[name=StartingDate3]").trigger('change');

            $('input[name=EndingDate3]').css({ "height": "22px", "width": "202px", "margin-bottom": "0px" });
            $('input[name=EndingDate3]').datepicker({ dateFormat: "dd-MM-yy" });
            $("input[name=EndingDate3]").trigger('change');

            $('input[name=StartingDate4]').css({ "height": "22px", "width": "202px", "margin-bottom": "0px" });
            $('input[name=StartingDate4]').datepicker({ dateFormat: "MM-yy" });
            $("input[name=StartingDate4]").trigger('change');

            $('input[name=StartingDate5]').css({ "height": "22px", "width": "202px", "margin-bottom": "0px" });
            $('input[name=StartingDate5]').datepicker({ dateFormat: "MM-yy" });
            $("input[name=StartingDate5]").trigger('change');

            $('input[name=StartingDate6]').css({ "height": "22px", "width": "202px", "margin-bottom": "0px" });
            $('input[name=StartingDate6]').datepicker({ dateFormat: "MM-yy" });
            $("input[name=StartingDate6]").trigger('change');

            $('input[name=EndingDate6]').css({ "height": "22px", "width": "202px", "margin-bottom": "0px" });
            $('input[name=EndingDate6]').datepicker({ dateFormat: "MM-yy" });
            $("input[name=EndingDate6]").trigger('change');

            $('input[name=StartingDate7]').css({ "height": "22px", "width": "202px", "margin-bottom": "0px" });
            $('input[name=StartingDate7]').datepicker({ dateFormat: "dd-MM-yy" });
            $("input[name=StartingDate7]").trigger('change');

            //BUTTONS CLICK REPORTS

            $("#GenerateReport1").click(function () {
                if ($("#StartingDate1").val() != "" || $("#EndingDate1").val() != "") {
                    if ($("#cbCheck1").is(':checked') == true) {
                        window.open("@Url.Action("FosDateWiseReport", "Retailer")" + "?StartingDate=" + $("#StartingDate1").val() + "&EndingDate=" + $("#EndingDate1").val() + "", "_top");
                    }
                    else {
                        window.open("@Url.Action("FosMonthWiseReport", "Retailer")" + "?StartingDate=" + $("#StartingDate1").val() + "&EndingDate=" + $("#EndingDate1").val() + "", "_top");
                    }
                }
                else {
                    alertify.error("Please Enter Dates")
                }

            });

            $("#GenerateReport2").click(function () {
                if ($("#StartingDate2").val() != "" || $("#EndingDate2").val() != "") {
                    if ($("#cbCheck2").is(':checked') == true) {
                        window.open("@Url.Action("CityDateWiseRetailerReport", "Retailer")" + "?StartingDate=" + $("#StartingDate2").val() + "&EndingDate=" + $("#EndingDate2").val() + "", "_top");
                    }
                    else {
                        window.open("@Url.Action("CityMonthWiseRetailerReport", "Retailer")" + "?StartingDate=" + $("#StartingDate2").val() + "&EndingDate=" + $("#EndingDate2").val() + "", "_top");
                    }
                }
                else {
                    alertify.error("Please Enter Dates")
                }

            });

            $("#GenerateReport3").click(function () {
                if ($("#StartingDate3").val() != "" || $("#EndingDate3").val() != "") {
                    if ($("#cbCheck3").is(':checked') == true) {
                        window.open("@Url.Action("RetailerShopDateWiseReport", "Retailer")" + "?StartingDate=" + $("#StartingDate3").val() + "&EndingDate=" + $("#EndingDate3").val() + "", "_top");
                    }
                    else {
                        window.open("@Url.Action("RetailerShopMonthWiseReport", "Retailer")" + "?StartingDate=" + $("#StartingDate3").val() + "&EndingDate=" + $("#EndingDate3").val() + "", "_top");
                    }
                }
                else {
                    alertify.error("Please Enter Dates")
                }

            });

            $("#GenerateReport4").click(function () {
                if ($("#StartingDate4").val() != "") {
                    window.open("@Url.Action("CityWiseFosReport", "Retailer")" + "?StartingDate=" + $("#StartingDate4").val() + "", "_top");
                }
                else {
                    alertify.error("Please Enter Dates")
                }

            });

            $("#GenerateReport5").click(function () {
                if ($("#StartingDate5").val() != "") {
                    window.open("@Url.Action("CityMktRtlrWiseReport", "Retailer")" + "?StartingDate=" + $("#StartingDate5").val() + "", "_top");
                }
                else {
                    alertify.error("Please Enter Dates")
                }

            });

            $("#GenerateReport6").click(function () {
                if ($("#StartingDate6").val() != "" || $("#EndingDate6").val() != "") {
                    window.open("@Url.Action("PosAvailabilityReport", "Retailer")" + "?StartingDate=" + $("#StartingDate6").val() + "&EndingDate=" + $("#EndingDate6").val() + "", "_top");
                }
                else {
                    alertify.error("Please Enter Dates")
                }

            });

            $("#FOSWiseOrderIntakeDeliveredReport").click(function myfunction() {
                $('input[name=StartingDate1]').val("");
                $('input[name=EndingDate1]').val("");
            });

            $("#CityWiseOrderIntakeDeliveredReport").click(function myfunction() {
                $('input[name=StartingDate2]').val("");
                $('input[name=EndingDate2]').val("");
            });

            $("#CityWiseFOS").click(function myfunction() {
                $('input[name=StartingDate3]').val("");
                $('input[name=EndingDate3]').val("");
            });

            $("#CityMarketRetailerWiseReport").click(function myfunction() {
                $('input[name=StartingDate4]').val("");
                $('input[name=EndingDate4]').val("");
            });

            $("#ShopWiseOrderIntakeDeliveredReport").click(function myfunction() {
                $('input[name=StartingDate5]').val("");
                $('input[name=EndingDate5]').val("");
            });

            $("#PaintersReportCityWise").click(function myfunction() {
                $('input[name=StartingDate6]').val("");
                $('input[name=EndingDate6]').val("");
            });

            $("#PaintersReportMarketWise").click(function myfunction() {
                $('input[name=StartingDate7]').val("");
                $('input[name=EndingDate7]').val("");
            });

            $("#PaintersReportRetailerWise").click(function myfunction() {
                $('input[name=StartingDate8]').val("");
                $('input[name=EndingDate8]').val("");
            });

            $("#RetailersPointSummary").click(function myfunction() {
                window.open("@Url.Action("RetailerPointSummary", "Retailer")", "_top");
            });

            @*$("#CityWisePainterReport").click(function myfunction() {
            //window.open("@Url.Action("CityWisePaintersReport", "Retailer")", "_top");
        });*@
            $("#GenerateReport7").click(function () {
                if ($("#StartingDate7").val() != "") {
                    window.open("@Url.Action("CityWisePaintersReport", "Retailer")" + "?StartingDate=" + $("#StartingDate7").val() + "", "_top");
                }
                else {
                    alertify.error("Please Enter Dates")
                }

            });

            $("#RetailersLedgerReport").click(function myfunction() {
                $('input[name=StartingDate10]').val("");
                $('input[name=EndingDate10]').val("");
            });

            $("#RetailersRedemptionReport").click(function myfunction() {
                $('input[name=StartingDate11]').val("");
                $('input[name=EndingDate11]').val("");
            });

            $("#MagneticCardReport").click(function myfunction() {
                $('input[name=StartingDate12]').val("");
                $('input[name=EndingDate12]').val("");
            });

            $("#POSAvailabilityReport").click(function myfunction() {
                $('input[name=StartingDate13]').val("");
                $('input[name=EndingDate13]').val("");
            });

            $("#FOSPlanningReport").click(function myfunction() {
                $('input[name=StartingDate14]').val("");
                $('input[name=EndingDate14]').val("");
            });

        });



      $('#btnNew').click(function () {
         location.reload();
      });

    $("#FaulttypeId").change(function () {
        debugger;
        LoadFaultTypeDetails();
        LoadProgressStatusDetails();
    });


         function LoadFaultTypeDetails() {
            var ClientID = $("#FaulttypeId").val();

        $.ajax({
            type: "POST",
            url: "@Url.Action("GetFaultTypeDetailList", "Complaint")",
            data: { ClientID: ClientID},
            success: function (json) {

                var $el = $("#FaulttypeDetailId");
                $el.empty(); // remove old options
                $.each(json, function (value, key) {
                    $el.append($("<option></option>").val(key.ID).text(key.Name));
                });


            }
        });
        }


        function LoadProgressStatusDetails() {
            var ClientID = $("#FaulttypeId").val();

        $.ajax({
            type: "POST",
            url: "@Url.Action("GetProgressDetailList", "Complaint")",
            data: { ClientID: ClientID},
            success: function (json) {

                var $el = $("#ProgressStatusId");
                $el.empty(); // remove old options
                $.each(json, function (value, key) {
                    $el.append($("<option></option>").val(key.ID).text(key.Name));
                });


            }
        });
    }




    </script>
